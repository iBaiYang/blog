---
layout: post
categories: IT技术
title: 网络协议
meta: 网络协议
---
* content
{:toc}

### 正文

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190828/20190828105908.png)

#### 包的封装(encapsulation)与解封装(Demultiplexing)

当应用程序使用网络传送数据时，数据按照协议栈从上到下的顺序，逐次通过每一层。其中每一层对收到的数据都要增加一些首部信息（有时还增加尾部信息）。
最终生成一串比特流通过以太网来传输，我们称这串比特流叫帧。

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190828/20190828111006.png)

当数据报到达链路层时，链路层也要对IP数据包封装进行包装。
链路层也要对IP数据包封装的方式主要有以太网IP数据包封装（RFC894）、IEEE 802 IP数据报封装（RFC1042）两种，
最常使用的封装格式是以太网IP数据包封装（RFC894）。下图显示了这两种不同形式的封装格式：

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190828/20190828111221.png)

从图中可以看到以太网封装限制了数据帧的最大长度为1500字节，这个限制叫做MTU，最大传输单元。

接收端收到帧之后，按照和上面相反的顺序（协议栈从下到上）来解包，依次解析每一层加入的头部（或尾部），最终将原始数据传给最上层应用程序。

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190828/20190828111522.png)

因为传输层的TCP、UDP、ICMP等都有可能向网络层IP协议传送数据，这样在IP协议层解包的时候，需要知道这个包对应的上层协议是哪一个，
因此IP协议必须在生成的IP首部加入某种标识，以表明数据的上一层的具体协议。为此，IP在首部中存入了一个长度为8bit的数值，称作协议域。常见的IP协议号有：
1表示ICMP协议，2表示IGMP协议，6表示TCP协议，17表示UDP协议。


<br/><br/><br/><br/><br/>
### 参考资料

TCP/IP详解 卷1：协议 <http://www.52im.net/topic-tcpipvol1.html>
 
网络协议 -- 基础概念 <https://blog.csdn.net/china_jeffery/article/details/78984287>

即时通讯网 <http://www.52im.net/thread-180-1-1.html>

网络协议 -- HTTP协议 <https://blog.csdn.net/china_jeffery/article/details/79495744>

了解网络协议的组成和常见的网络协议 <https://baijiahao.baidu.com/s?id=1621785698050032876&wfr=spider&for=pc>


---
layout: post
categories: Laravel
title: Laravel 服务提供者
meta: Laravel 服务提供者
---
* content
{:toc}

## 基本概念

服务提供者是所有 Laravel 应用程序的引导中心。你的应用程序，以及 通过服务器引导的 Laravel 核心服务都是通过服务提供器引导。

但是，「引导」是什么意思呢？ 通常，我们可以理解为注册，比如注册服务容器绑定，事件监听器，中间件，甚至是路由。服务提供者是配置应用程序的中心。

当打开 Laravel 的 config/app.php 文件时，会看到 providers 数组。数组中的内容是应用程序要加载的所有服务提供者的类。当然，其中有很多 「延迟」 提供者，他们并不会在每次请求的时候都加载，只有他们的服务实际被需要时才会加载。

「服务提供者」是配置应用的中心，它的主要工作是使用「服务容器」实现服务容器绑定、事件监听器、中间件，甚至是路由的注册。

除核心服务外，几乎所有的服务提供者都定义在配置文件 config/app.php 文件中的 providers 节点中。

服务提供者的典型处理流程是，当接 Laravel 应用接收到 HTTP 请求时会去执行「服务提供者的 register（注册）」方法，将各个服务「绑定」到容器内；之后，到了实际处理请求阶段，依据使用情况按需加载所需服务。这样的优势很明显能够提升应用的性能。

还有一些核心服务提供者并没有定义在 providers 配置节点中，而是直接在 Illuminate\Foundation\Application 服务容器实例化阶段就完成了注册服务：
```php
<?php
...

class Application extends Container implements ApplicationContract, HttpKernelInterface
{
    /**省略若干**/

    public function __construct($basePath = null)
    {
        ...
        $this->registerBaseServiceProviders();
        ...
    }

    /**
     * Register all of the base service providers. 
     * 注册应用基础服务提供者
     *
     * @return void
     */
    protected function registerBaseServiceProviders()
    {
        $this->register(new EventServiceProvider($this));  // 事件服务提供者

        $this->register(new LogServiceProvider($this));  // 日志服务提供者
        
        $this->register(new RoutingServiceProvider($this));  // 路由服务提供者
    }

    /**省略若干**/
}
```






## 参考资料

Laravel 6 中文文档  <https://learnku.com/docs/laravel/6.x/providers/5132>

深入剖析 Laravel 服务提供者实现原理 <https://learnku.com/articles/12986/in-depth-analysis-of-the-principle-of-laravel-service-provider-implementation>

Laravel 服务提供者指南 <https://learnku.com/articles/12852/laravel-service-provider-guide>


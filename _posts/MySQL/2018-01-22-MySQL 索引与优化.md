---
layout: post
categories: MySQL
title: MySQL 索引与优化
meta: 细细研究。
---
* content
{:toc}

### 正文

细细研究
 
![]({{site.baseurl}}/images/20200330/20200330191563.jpeg)

#### 增加索引

一种是在表创建时就增加索引，如：
```
CREATE TABLE `complaint_channel` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `workorder_id` int(11) NOT NULL COMMENT '工单ID',
  `channel_type` tinyint(4) NOT NULL DEFAULT '0' COMMENT '投诉渠道类型，1：400电话，2：公众号/app留言，3：公众号/app投诉建议，99：其他',
  `created_time` int(11) NOT NULL COMMENT '添加时间',
  PRIMARY KEY (`id`),
  KEY `idx_workorder_id` (`workorder_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='投诉渠道记录表';
```

idx_workorder_id 就是增加的 索引。

一种是后期新增，如：
```
ALTER TABLE `workorder` ADD INDEX idx_type_id (`type_id`) ;
```

idx_type_id 就是增加的 索引。

#### 索引类型

B-Tree索引

Hash索引

空间(R-Tree)索引

全文(Full-text)索引


#### 读取提速

一种读取慢的可能是分页查询，第一页1s以内，第二页2s，第三页3s，第四页4s......随着页数增加，读取时间越来越长，
这是MySQl底层决定的，查询后面页码数据时，会先过一遍前几页的数据，所以时间变长了。
解决的办法是第2页查询时，改成第1页查询的语句结构。

如，获取第6页;
`SELECT id FROM user WHERE status = 1 limit 500 100;`

改为：
`SELECT id FROM user WHERE status = 1 AND id > 1275 limit 500 100;`

把第5页获取到的最后一个id，作为下一页查询的过滤条件。

<br/><br/><br/><br/><br/>
### 参考资料 

<https://www.cnblogs.com/hustcat/archive/2009/10/28/1591648.html>

<http://www.runoob.com/mysql/mysql-index.html>
      
<http://blog.csdn.net/xluren/article/details/32746183>
      
<http://zccst.iteye.com/blog/1697043>
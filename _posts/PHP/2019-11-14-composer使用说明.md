---
layout: post
categories: PHP
title: composer使用说明
meta: composer使用说明
---
* content
{:toc}

### 正文

composer安装好后，我们就可以在项目中使用composer了。

在项目指定目录下新建 composer.json 文件，写入依赖的包，如：
```
{
    "require": {
        "php": ">=7.0.0",
        "yiisoft/yii2": "~2.0.15",
        "nmred/kafka-php": "0.2.*",
        "peachpear/pear-leaf": "1.0.*"
    }
}
```

然后cd到该层目录下执行 composer install，就进入自动安装，安装完成后会生成一个composer.lock文件，里面是特定的版本号名，
需要把这个文件和composer.json一起提交到版本管理里去。依赖包则全部安装到了项目根目录的verdor目录下。

更新依赖：
```
composer update
```

如果只想更新部分依赖：
```
composer update peachpear/pear-leaf
```

#### 期间问题

期间发现一个问题，Yii2安装时需要 bower-asset/jquery 3.4.*@stable：

![]({{site.baseurl}}/images/20191114/20191114113942.png)

需要需要引入 bower-asset/jquery，有两种方式：
```
// 全局安装
composer global require "fxp/composer-asset-plugin"
 
// 或者项目内引入
composer require --dev "fxp/composer-asset-plugin"
```

如果全局安装没效果，就项目内引入。

![]({{site.baseurl}}/images/20200605/20200605160127.png)

期间又发现另外一个问题，GitHub OAuth token or enter a new one to go over the API rate limit 。

![]({{site.baseurl}}/images/20191114/20191114124600.png)

提示中说明了获取地址： https://github.com/settings/tokens/new?scopes=repo&description=Composer+on+pc+2019-11-14+1145 。
我们通过浏览器打开，发现是生成token页面，选项也默认选择了，我们只要点击下方的确认就可以。

![]({{site.baseurl}}/images/20191114/20191114125210.png)

复制生成的token.在刚才执行的命令行中要token的地方粘贴并回车：

![]({{site.baseurl}}/images/20191114/20191114124634.png)

可以看到终于把所有依赖包都安装完毕。

#### 移除依赖

移除指定依赖：

> composer remove yiisoft/yii2

不过这只是删除了依赖关系，不会自动加载，但其依赖包还在vender文件夹里，可手动删除。

<br/><br/><br/><br/><br/>
### 参考资料

Linux 下安装Composer <https://ibaiyang.github.io/blog/linux/2017/07/25/Linux-%E4%B8%8B%E5%AE%89%E8%A3%85Composer.html>

Composer —— A Dependency Manager for PHP <https://getcomposer.org/>

基本用法 - Composer 中文文档 - Composer 中文网 <https://docs.phpcomposer.com/01-basic-usage.html>

Composer安装和使用 <https://www.jianshu.com/p/256547b495c2>

composer.json 中的各个属性字段详解 <https://blog.zzstudio.net/bs/article_1098.html>

yii2 composer 下载扩展解决jquery版本错误 <https://blog.csdn.net/wpj130/article/details/88743232>

YII2 composer update 报错解决一例-requires bower-asset/jquery 2.2 <https://www.cnblogs.com/rxbook/p/11043900.html>
---
layout: post
categories: PHP
title: PHP中PSR规范
meta: PHP中PSR规范
---
* content
{:toc}

## 正文

PSR 是由 PHP FIG 组织制定的 PHP 规范，是 PHP 开发的实践标准。 

**PHP FIG**

PSR 是 PHP Standard Recommendations （PHP 推荐标准）的简写，由 PHP FIG 组织制定的 PHP 规范，是 PHP 开发的实践标准。

PHP FIG，FIG 是 Framework Interoperability Group（框架可互用性小组）的缩写，由几位开源框架的开发者成立于 2009 年，
从那开始也选取了很多其他成员进来（包括但不限于 Laravel, Joomla, Drupal, Composer, Phalcon, Slim, Symfony, Zend Framework 等），
虽然不是「官方」组织，但也代表了大部分的 PHP 社区。

项目的目的在于：通过框架作者或者框架的代表之间讨论，以最低程度的限制，制定一个协作标准，各个框架遵循统一的编码规范，
避免各家自行发展的风格阻碍了 PHP 的发展，解决这个程序设计师由来已久的困扰。

目前已表决通过了不少套标准，已经得到大部分 PHP 框架的支持和认可。

本项目的主要面向对象是所有参与的各个成员（也就是各自框架的社区），这里是完整的 成员列表，当然，同时也欢迎其它 PHP 社区采用本规范。

**状态说明**

在本文档的文章列表中，文章标题会有规范状态的标示。所有的规范分为以下几个状态：

    已通过（ACCEPTED）—— 文章标题将不会有所显示
    起草中（DRAFT）—— 暂不翻译
    未通过（ABANDONED）—— 简单说明，暂不翻译
    已弃用（DEPRECATED）—— 会有说明，暂不翻译

**规范目录**

    PSR-0 自动加载规范（已弃用）
    PSR-1 基础编码规范 已完成
    PSR-2 编码风格规范（已弃用） 已完成
    PSR-3 日志接口规范 已完成
    PSR-4 自动加载规范 已完成
    PSR-4 自动加载规范 - 示例文档 已完成
    PSR-4 自动加载规范 - 说明文档 已完成
    PSR-5 PHPDoc 标准（未通过）
    PSR-6 缓存接口规范 已完成
    PSR-6 缓存接口规范 - 说明文档 已完成
    PSR-7 HTTP 消息接口规范 已完成
    PSR-8 Huggable 接口（未通过）
    PSR-9 项目安全问题公示（未通过）
    PSR-10 项目安全上报方法（未通过）
    PSR-11 容器接口 已完成
    PSR-11 容器接口 - 说明文档 已完成
    PSR-12 编码规范扩充
    PSR-13 超媒体链接 已完成
    PSR-13 超媒体链接 - 说明文档 已完成
    PSR-14 事件分发器
    PSR-15 HTTP 请求处理器 已完成
    PSR-16 缓存接口 已完成
    PSR-16 缓存接口 - 说明文档 已完成
    PSR-17 HTTP 工厂 已完成
    PSR-18 HTTP 客户端 已完成 

### PSR-1 基础编码规范 

本篇规范制定了代码基本元素的相关标准，以确保共享的 PHP 代码间具有较高程度的技术互通性。

本文件中的 必须，不得，需要，应，不应，应该，不应该，推荐，可能 和 可选 等能愿动词按照 RFC 2119 中的描述进行解释。

1. 概览

PHP 代码文件 必须 以 `<?php` 或 `<?=` 标签开始；

PHP 代码文件 必须 以 不带 BOM 的 UTF-8 编码；

PHP 代码中 应该 声明任一标志（类、函数、常量等），或引起副作用（如果一个函数修改了自己范围之外的资源，
那就叫做有副作用，如：生成输出以及修改 .ini 配置文件等），但是不应该二者都有；

命名空间以及类 必须 符合 PSR 的自动加载规范： [PSR-0（已废弃）或 PSR-4] 中的一个。

类的命名 必须 遵循 StudlyCaps 大写开头的驼峰命名规范；

类中的常量所有字母都 必须 大写，单词间用下划线分隔；

方法名称 必须 符合 camelCase 式的小写开头驼峰命名规范。

2. 文件

2.1. PHP 标签

PHP 代码 必须 使用 <?php ?> 长标签 或 <?= ?> 短输出标签；

一定不可 使用其它自定义标签。

2.2. 字符集编码

PHP 代码 必须 且只可使用 不带 BOM 的 UTF-8 编码。

2.3. 副作用

一份 PHP 文件中 应该 要不就只定义新的声明，如类、函数或常量等不产生 副作用 的操作，
要不就只执行会产生 副作用 的逻辑操作，但 不该 同时具有两者。

「副作用」(side effects) 一词的意思是，仅仅通过包含文件，不直接声明类、函数和常量等，而执行的逻辑操作。

「副作用」包含却不仅限于：生成输出，明确使用 require 或 include，连接到外部服务，
修改 ini 设置，发出错误或异常，修改全局或静态变量，读取或写入一个文件，等等。

以下是一个 反例，一份包含「函数声明」以及产生「副作用」的代码：
```php
<?php
// 「副作用」：修改 ini 配置
ini_set('error_reporting', E_ALL);

// 「副作用」：引入文件
include "file.php";

// 「副作用」：生成输出
echo "<html>\n";

// 声明函数
function foo()
{
    // function body
}
```

下面是一个范例，一份只包含声明不产生「副作用」的代码：
```
<?php
// 声明函数
function foo()
{
    // 函数主体部分
}

// 条件声明 **不** 属于「副作用」
if (! function_exists('bar')) {
    function bar()
    {
        // 函数主体部分
    }
}
```

3. 命名空间和类名

命名空间和类名 必须 遵循『自动加载』规范： [PSR-0， PSR-4]。

这意味着每个类都独立为一个文件，并且至少在一个层次的命名空间内，那就是：顶级组织名（vendor name）。

类名 必须 以类似 StudlyCaps 形式的大写开头的驼峰命名方式声明。

PHP 5.3 及更高版本的代码 必须 使用正式的命名空间。

举个例子：
```
<?php
// PHP 5.3 及更高版本：
namespace Vendor\Model;

class Foo
{
}
```

PHP 5.2 及更低版本 应该 使用伪命名空间，约定俗成，以顶级组织名称 Vendor_ 为类名前缀：
```
<?php
// PHP 5.2.x 及更低版本：
class Vendor_Model_Foo
{
}
```

4. 类的常量、属性和方法

此处的「类」指代所有的类、接口以及可复用代码块（traits）。

4.1. 常量

类的常量中所有字母都 必须 大写，词间以下划线分隔。例如：
```
<?php
namespace Vendor\Model;

class Foo
{
    const VERSION = '1.0';
    const DATE_APPROVED = '2012-06-01';
}
```

4.2. 属性

类的属性命名 可以 遵循：

    大写开头的驼峰式 ($StudlyCaps)
    小写开头的驼峰式 ($camelCase)
    下划线分隔式 ($under_score)

本规范不做强制要求，但无论遵循哪种命名方式，都 应该 在一定的范围内保持一致。这个范围可以是整个团队、整个包、整个类或整个方法。

4.3. 方法

方法名称 必须 符合 camelCase() 式的小写开头驼峰命名规范。



## 参考资料

PHP PSR 标准规范 <https://learnku.com/docs/psr>

PSR-0: Autoloading Standard <https://www.php-fig.org/psr/psr-0/>

PSR-1 基础编码规范 <https://laravel-china.org/topics/2078>

PEAR 编码准则 <https://pear.php.net/manual/en/standards.php>

Symfony 编码准则 <https://symfony.com/doc/current/contributing/code/standards.html>

PHP中PSR-[0-4]规范：<http://m.blog.csdn.net/article/details?id=42844391>

PHP中PSR-[0-4]规范：<https://www.zybuluo.com/phper/note/65033>


---
layout: post
categories: PHP
title: PHP 中xml的使用
meta: PHP 中xml的使用
---
* content
{:toc}

### 正文

要用php生成这样的xml格式数据：

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190831/20190831232036.jpeg)

怎么处理呢？用下面这段代码就可以：
```
public function setXmlData($data = [])
{
    $xml = new \SimpleXMLElement('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><root/>');
    foreach ($data as $key => $value)
    {
        $item = $xml->addChild($key, $value);
    }
    
    return $xml->asXML();
}
```

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190831/20190831232116.jpeg)

#### 解析XML

解析XML用simplexml_load_string()，不过需要给PHP安装 SimpleXML 扩展。

如果收到一段xml格式的数据怎么办呢？转成array数组格式：
```
public function unsetXmlData($xml = "")
{
    $obj = simplexml_load_string($xml);
    $arr = json_decode(json_encode($obj), true);
}
```

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190831/20190831232145.jpeg)

无论是几层，有几层就返回几层数组。

```
<?php
$string = <<<XML
<?xml version='1.0'?>
<document>
    <cmd>login</cmd>
    <login>Richard</login>
</document>
XML;
                                                                               
$xml = simplexml_load_string($string);
print_r($xml);
$login = $xml->login;
print_r($login);
$login = (string) $xml->login;
print_r($login);
?>
```

期望结果:
```
SimpleXMLElement Object
(
    [cmd] => login
    [login] => Richard
)
Richard
Richard
```

实际结果:
```
SimpleXMLElement Object
(
    [cmd] => login
    [login] => Richard
)
SimpleXMLElement Object
(
    [0] => Richard
)
Richard 
```

理解一下。

<br/><br/><br/><br/><br/>
### 参考资料

PHP 手册 函数参考 XML 操作 <https://www.php.net/manual/zh/refs.xml.php>

PHP中的XML解析的5种方法 <https://www.cnblogs.com/caicaizi/p/7837286.html>

PHP 手册 函数参考 XML 操作 SimpleXML <https://www.php.net/manual/zh/book.simplexml.php>

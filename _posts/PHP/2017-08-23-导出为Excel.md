---
layout: post
categories: PHP
title: 导出为Excel
meta: 有时有一些需求需要导出表格数据为Excel，下面就谈一下这方面的内容。
---
* content
{:toc}

### 正文

php怎么导出EXCEL文件呢？如果是ThinkPHP，可能会想到用PHPExcel，但是这个组件在数据量大时会导致内存溢出，那么有没有其他好方法呢？下面介绍一种:

<pre style="background-color:#272822;color:#f8f8f2;font-family:'Source Code Pro';font-size:12.0pt;"><span style="color:#66d9ef;">function </span><span style="color:#a6e22e;">excelData</span>( <span style="color:#ffffff;">$datas, $tdtitle, $headtitle, $filename </span>)<br>{<br>
    <span style="color:#ffffff;">$str </span><span style="color:#f72671;">= </span><span style="color:#ffde6b;">"&lt;html xmlns:</span><span style="color:#660e7a;font-weight:bold;">o</span><span style="color:#ffde6b;">=</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">urn:schemas-microsoft-com:office:office</span><span style="color:#ae81ff;">\"\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;xmlns:</span><span style="color:#660e7a;font-weight:bold;">x</span><span style="color:#ffde6b;">=</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">urn:schemas-microsoft-com:office:excel</span><span style="color:#ae81ff;">\"\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;xmlns=</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">http://www.w3.org/TR/REC-html40</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">&gt;</span><span style="color:#ae81ff;">\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;head&gt;</span><span style="color:#ae81ff;">\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;meta http-equiv=Content-Type content=</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">text/html; charset=utf-8</span><span style="color:#ae81ff;">\"</span><span style="color:#ffde6b;">&gt;</span><span style="color:#ae81ff;">\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/head&gt;</span><span style="color:#ae81ff;">\r\n</span><span style="color:#ffde6b;"><br></span><span style="color:#ffde6b;"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;body&gt;"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;$str </span><span style="color:#f72671;">.=</span><span style="color:#ffde6b;">"&lt;table border=1&gt;&lt;head&gt;"</span><span style="color:#f72671;">.</span><span style="color:#ffffff;">$headtitle</span><span style="color:#f72671;">.</span><span style="color:#ffde6b;">"&lt;/head&gt;"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;$str </span><span style="color:#f72671;">.= </span><span style="color:#ffffff;">$tdtitle;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">foreach </span>(<span style="color:#ffffff;">$datas </span><span style="color:#66d9ef;">as </span><span style="color:#ffffff;">$key</span><span style="color:#f72671;">=&gt; </span><span style="color:#ffffff;">$rt </span>)<br>    {<br>        <span style="color:#ffffff;">$str </span><span style="color:#f72671;">.= </span><span style="color:#ffde6b;">"&lt;tr&gt;"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color:#66d9ef;">foreach </span>( <span style="color:#ffffff;">$rt </span><span style="color:#66d9ef;">as </span><span style="color:#ffffff;">$k </span><span style="color:#f72671;">=&gt; </span><span style="color:#ffffff;">$v </span>)<br>        {<br>            <span style="color:#ffffff;">$str </span><span style="color:#f72671;">.= </span><span style="color:#ffde6b;">"&lt;td&gt;</span>{<span style="color:#ffffff;">$v</span>}<span style="color:#ffde6b;">&lt;/td&gt;"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp; &nbsp; &nbsp;</span>}<br>        <span style="color:#ffffff;">$str </span><span style="color:#f72671;">.= </span><span style="color:#ffde6b;">"&lt;/tr&gt;</span><span style="color:#ae81ff;">\n</span><span style="color:#ffde6b;">"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span>}<br>    <span style="color:#ffffff;">$str </span><span style="color:#f72671;">.= </span><span style="color:#ffde6b;">"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;"</span><span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Content-Type: application/vnd.ms-excel; name='excel'" </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Content-type: application/octet-stream" </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Content-Disposition: attachment; filename="</span><span style="color:#f72671;">.</span><span style="color:#ffffff;">$filename </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Cache-Control: must-revalidate, post-check=0, pre-check=0" </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Pragma: no-cache" </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">header</span>( <span style="color:#ffde6b;">"Expires: 0" </span>)<span style="color:#ffffff;">;<br></span><span style="color:#ffffff;"> &nbsp; &nbsp;</span><span style="color:#66d9ef;">exit</span>( <span style="color:#ffffff;">$str </span>)<span style="color:#ffffff;">;<br></span>}</pre>

使用方法：

![](https://raw.githubusercontent.com/iBaiYang/PictureWareroom/master/20190901/20190901005029.jpeg)


<br><br><br><br><br>
### 参考资料：

<http://www.cnblogs.com/followyou/p/6143168.html>

